# 📋 포스트 목록 페이지 요구사항 (`/merry`)

> **메르의 모든 블로그 포스트를 필터링, 검색, 탐색할 수 있는 목록 페이지**

## 🎯 페이지 개요
- **페이지 경로**: `/merry`  
- **담당 파일**: `src/app/merry/page.tsx`  
- **목적**: 메르의 모든 블로그 포스트 목록 표시 및 필터링

## 🔗 연결되는 페이지
- **개별 포스트**: `/merry/[id]` (포스트 카드 클릭 시)
- **종목 페이지**: `/merry/stocks/[ticker]` (종목 태그 클릭 시)

## 🏷️ **포스트별 독립 태그 시스템** (핵심 기능)

### 기존 문제점
- 모든 포스트가 동일한 태그('투자', '분석') 표시로 구분 불가
- 사용자가 포스트들을 구별하기 어려움

### 해결 방안: 동적 태그 시스템
- **데이터 기반**: blog_posts 테이블의 새로운 3개 컬럼 활용
  - **mentioned_stocks** (TEXT): 언급된 종목명 (쉼표 구분)
  - **investment_theme** (TEXT): 투자 테마  
  - **sentiment_tone** (TEXT): 감정 톤 (긍정적/중립적/부정적)

### 태그 생성 규칙
- **우선순위**: 언급 종목 (최대 2개) → 투자 테마 → 감정 톤 (이모지 포함)
- **감정 표시**: 😊긍정적, 😐중립적, 😰부정적 이모지와 함께 표시
- **Fallback 처리**: 모든 필드가 비어있을 경우 기본 태그 ['투자', '분석'] 사용

### 🚨 **절대 원칙: 글이 없으면 태그를 생성하지 말라**
- **포스트에 해당 내용이 없으면 절대 태그 생성 금지**
- 실제 내용에 기반하지 않은 분석 결과 저장 금지
- 해당 정보가 없으면 NULL 또는 빈 값으로 저장
- **예시**: 파월 잭슨홀 포스트에 암호화폐 언급이 전혀 없으면 mentioned_stocks는 NULL
- **Claude 직접 분석**: AI API 사용 절대 금지, Claude가 수동으로 포스트 내용 읽고 분석

## 🎨 UI/UX 요구사항

### 📋 헤더 섹션
- **제목**: "🎭 우리형 메르" (text-foreground, 다크 모드 지원)
- **부제목**: "일상, 투자, 독서, 그리고 삶의 다양한 이야기들..." (text-muted-foreground)
- **폰트 크기**: text-4xl font-bold (제목), text-lg (부제목)

### 🔍 필터 섹션
- **배경**: `bg-muted/50 border` (다크 모드 호환)
- **필터 아이콘**: `Filter` 아이콘 + "필터:" 텍스트 (text-foreground)
- **필터 유형**:
  1. **기간 필터**: 전체/최근 1주/1개월/3개월/1년
  2. **종목 필터**: 📈 종목 토글 버튼
  3. **매크로 필터**: 🌐 매크로 토글 버튼  
  4. **특정 종목**: 드롭다운으로 개별 종목 선택
  5. **초기화 버튼**: 모든 필터 해제

### 📝 포스트 리스트 섹션
- **제목**: "📝 모든 포스트 (총 N개)" (text-foreground)
- **카드 레이아웃**: 그리드 (md:grid-cols-2 lg:grid-cols-3)
- **포스트 카드**: hover:shadow-lg transition-shadow
- **더보기**: "더보기 (10개씩)" 버튼으로 페이지네이션

### 포스트 카드 정보
- **필수 정보**: 제목, 내용 미리보기, 작성자(메르), 작성일
- **선택 정보**: 조회수, 좋아요, 댓글 수, 동적 태그
- **링크**: `/merry/{post.id}`로 개별 포스트 페이지 이동
- **동적 태그 처리**: 포스트별 독립 특성 기반 태그 생성, 최대 3개 표시

## 🌈 다크 모드 지원

### 🎨 색상 시스템 (필수)
```typescript
// ✅ 다크 모드 호환 색상
text-foreground        // 주요 텍스트
text-muted-foreground  // 보조 텍스트  
bg-muted/50           // 필터 배경
bg-card               // 카드 배경
border                // 테두리

// ❌ 사용 금지 색상 (다크 모드 비호환)
text-gray-900         // 하드코딩된 회색
bg-gray-50           // 하드코딩된 배경
text-gray-600        // 하드코딩된 회색
```

## 📡 API 연동

### 🔗 메인 API: `/api/merry/posts`
```typescript
// 요청 파라미터
interface PostsRequest {
  limit: number;        // 페이지당 포스트 수 (기본: 10)
  offset: number;       // 페이지네이션 오프셋
  date?: string;        // 'all' | 'week' | 'month' | 'quarter' | 'year'
  stocks?: '1';         // 종목 관련 포스트만
  macro?: '1';          // 매크로 관련 포스트만  
  ticker?: string;      // 특정 종목 티커
}

// 응답 형식 (동적 태그 시스템 포함)
interface PostsResponse {
  success: boolean;
  data: MerryPost[];
  meta: {
    total: number;      // 전체 포스트 수 (필수)
    hasNext: boolean;   // 더 보기 여부
  };
}

// 포스트 데이터 구조 (새로운 필드 포함)
interface MerryPost {
  // 기존 필드들...
  tags: string[];              // 동적 생성된 태그 배열
  mentionedStocks?: string[];  // 언급된 종목 목록
  investmentTheme?: string;    // 투자 테마
  sentimentTone?: string;      // 감정 톤 (긍정적/중립적/부정적)
}
```

### 🔗 종목 목록 API: `/api/merry/stocks`
```typescript
// 필터용 종목 목록 로드
interface StocksResponse {
  success: boolean;
  data: {
    stocks: Array<{
      ticker: string;
      name: string;
      mention_count: number;
    }>;
  };
}
```

## 🎯 성능 요구사항

### ⚡ 로딩 성능
- **초기 로딩**: < 3초 (CLAUDE.md 핵심 원칙)
- **API 응답**: < 500ms
- **페이지네이션**: < 1초
- **필터 적용**: < 800ms

### 🔄 최적화 전략
- **필터 변경 시**: 전체 포스트 다시 로드 (offset=0)
- **더보기 클릭 시**: 기존 포스트에 추가 (append)
- **검색/필터**: useEffect로 자동 적용
- **에러 처리**: 로딩 실패 시 사용자에게 명확한 안내

## 🚨 주의사항

### ❌ 금지 사항
- **하드코딩된 색상**: `text-gray-900`, `bg-gray-50` 등 사용 금지
- **Dummy 데이터**: 실제 API 데이터만 사용
- **가짜 총 개수**: `posts.length`가 아닌 `meta.total` 사용
- **필터 없는 시간**: 모든 필터 기능 정상 동작 필수

### ✅ 필수 준수사항
- **다크 모드 완전 지원**: 모든 UI 요소
- **실제 데이터만 사용**: API에서 가져온 실제 포스트
- **3초 로딩 제한**: 성능 최적화 필수
- **필터 동기화**: URL과 상태 동기화 권장

---

## 📝 요약

**메르 포스트 목록은 "글이 없으면 태그를 생성하지 말라" 원칙하에 포스트별 고유한 동적 태그를 제공하는 고성능 필터링 시스템입니다.**

핵심 기능:
1. 🏷️ **동적 태그**: 실제 내용 기반 포스트별 고유 태그
2. 🔍 **다중 필터**: 기간/종목/매크로/특정종목 필터링  
3. 📊 **실제 총 개수**: DB 기반 정확한 포스트 수 표시
4. ⚡ **고성능**: 3초 이내 로딩, 500ms API 응답
5. 🎨 **다크 모드**: semantic 색상으로 완전 호환